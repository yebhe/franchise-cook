# Generated by Django 5.2.4 on 2025-08-04 04:57

import django.db.models.deletion
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Camion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_camion', models.CharField(max_length=20, unique=True)),
                ('marque', models.CharField(blank=True, max_length=50)),
                ('modele', models.CharField(blank=True, max_length=50)),
                ('annee_fabrication', models.PositiveIntegerField(blank=True, null=True)),
                ('immatriculation', models.CharField(max_length=15, unique=True)),
                ('statut', models.CharField(choices=[('disponible', 'Disponible'), ('attribue', 'Attribué'), ('maintenance', 'Maintenance'), ('hors_service', 'Hors service')], default='disponible', max_length=20)),
                ('date_attribution', models.DateField(blank=True, null=True)),
                ('kilometrage', models.PositiveIntegerField(default=0)),
                ('date_derniere_revision', models.DateField(blank=True, null=True)),
                ('prochaine_revision', models.DateField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Camion',
                'verbose_name_plural': 'Camions',
            },
        ),
        migrations.CreateModel(
            name='CategorieProduit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom_categorie', models.CharField(max_length=50)),
                ('description', models.TextField(blank=True)),
                ('statut', models.CharField(choices=[('actif', 'Actif'), ('inactif', 'Inactif')], default='actif', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Catégorie de produit',
                'verbose_name_plural': 'Catégories de produits',
            },
        ),
        migrations.CreateModel(
            name='Emplacement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom_emplacement', models.CharField(max_length=100)),
                ('adresse', models.CharField(blank=True, max_length=255)),
                ('ville', models.CharField(blank=True, max_length=50)),
                ('code_postal', models.CharField(blank=True, max_length=10)),
                ('type_zone', models.CharField(choices=[('centre_ville', 'Centre-ville'), ('zone_commerciale', 'Zone commerciale'), ('parc', 'Parc'), ('entreprise', 'Entreprise'), ('marche', 'Marché'), ('autre', 'Autre')], default='autre', max_length=20)),
                ('tarif_journalier', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('horaires_autorises', models.CharField(blank=True, max_length=100)),
                ('statut', models.CharField(choices=[('disponible', 'Disponible'), ('occupe', 'Occupé'), ('ferme', 'Fermé')], default='disponible', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Emplacement',
                'verbose_name_plural': 'Emplacements',
            },
        ),
        migrations.CreateModel(
            name='Entrepot',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom_entrepot', models.CharField(max_length=100)),
                ('adresse', models.CharField(max_length=255)),
                ('ville', models.CharField(max_length=50)),
                ('code_postal', models.CharField(max_length=10)),
                ('telephone', models.CharField(blank=True, max_length=15)),
                ('email', models.EmailField(blank=True, max_length=254)),
                ('responsable', models.CharField(blank=True, max_length=100)),
                ('capacite_max', models.PositiveIntegerField(blank=True, null=True)),
                ('statut', models.CharField(choices=[('actif', 'Actif'), ('maintenance', 'Maintenance'), ('ferme', 'Fermé')], default='actif', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Entrepôt',
                'verbose_name_plural': 'Entrepôts',
            },
        ),
        migrations.CreateModel(
            name='AffectationEmplacement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date_debut', models.DateField()),
                ('date_fin', models.DateField(blank=True, null=True)),
                ('horaire_debut', models.TimeField(blank=True, null=True)),
                ('horaire_fin', models.TimeField(blank=True, null=True)),
                ('statut', models.CharField(choices=[('programme', 'Programmé'), ('en_cours', 'En cours'), ('termine', 'Terminé'), ('annule', 'Annulé')], default='programme', max_length=20)),
                ('commentaire', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('camion', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='affectations', to='gestion_camions.camion')),
                ('emplacement', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='affectations', to='gestion_camions.emplacement')),
            ],
            options={
                'verbose_name': 'Affectation emplacement',
                'verbose_name_plural': 'Affectations emplacements',
                'ordering': ['-date_debut'],
            },
        ),
        migrations.CreateModel(
            name='Franchise',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom_franchise', models.CharField(max_length=100)),
                ('prenom_gerant', models.CharField(max_length=50)),
                ('nom_gerant', models.CharField(max_length=50)),
                ('telephone', models.CharField(blank=True, max_length=15)),
                ('adresse', models.CharField(blank=True, max_length=255)),
                ('ville', models.CharField(blank=True, max_length=50)),
                ('code_postal', models.CharField(blank=True, max_length=10)),
                ('date_signature', models.DateField()),
                ('droit_entree', models.DecimalField(decimal_places=2, default=Decimal('50000.00'), max_digits=10)),
                ('statut', models.CharField(choices=[('actif', 'Actif'), ('suspendu', 'Suspendu'), ('resilie', 'Résilié')], default='actif', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='franchise', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Franchisé',
                'verbose_name_plural': 'Franchisés',
            },
        ),
        migrations.CreateModel(
            name='CommandeFranchise',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('numero_commande', models.CharField(default=uuid.uuid4, max_length=20, unique=True)),
                ('date_commande', models.DateField(auto_now_add=True)),
                ('date_livraison_prevue', models.DateField(blank=True, null=True)),
                ('date_livraison_reelle', models.DateField(blank=True, null=True)),
                ('montant_total', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('montant_obligatoire', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('montant_libre', models.DecimalField(decimal_places=2, default=Decimal('0.00'), max_digits=10)),
                ('statut', models.CharField(choices=[('en_attente', 'En attente'), ('validee', 'Validée'), ('preparee', 'Préparée'), ('livree', 'Livrée'), ('annulee', 'Annulée')], default='en_attente', max_length=20)),
                ('commentaire', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('entrepot', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='commandes', to='gestion_camions.entrepot')),
                ('franchise', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='commandes', to='gestion_camions.franchise')),
            ],
            options={
                'verbose_name': 'Commande franchise',
                'verbose_name_plural': 'Commandes franchises',
                'ordering': ['-date_commande'],
            },
        ),
        migrations.AddField(
            model_name='camion',
            name='franchise',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='camions', to='gestion_camions.franchise'),
        ),
        migrations.CreateModel(
            name='LogAction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(max_length=100)),
                ('table_concernee', models.CharField(blank=True, max_length=50)),
                ('id_enregistrement', models.PositiveIntegerField(blank=True, null=True)),
                ('anciennes_valeurs', models.JSONField(blank=True, null=True)),
                ('nouvelles_valeurs', models.JSONField(blank=True, null=True)),
                ('adresse_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('franchise', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='logs', to='gestion_camions.franchise')),
                ('utilisateur', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': "Log d'action",
                'verbose_name_plural': "Logs d'actions",
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='MaintenanceCamion',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('type_maintenance', models.CharField(choices=[('revision', 'Révision'), ('reparation', 'Réparation'), ('controle_technique', 'Contrôle technique'), ('autre', 'Autre')], max_length=20)),
                ('description', models.TextField(blank=True)),
                ('date_maintenance', models.DateField()),
                ('cout', models.DecimalField(blank=True, decimal_places=2, max_digits=8, null=True)),
                ('garage', models.CharField(blank=True, max_length=100)),
                ('kilometrage_maintenance', models.PositiveIntegerField(blank=True, null=True)),
                ('prochaine_echeance', models.DateField(blank=True, null=True)),
                ('statut', models.CharField(choices=[('programme', 'Programmé'), ('en_cours', 'En cours'), ('termine', 'Terminé')], default='programme', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('camion', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='maintenances', to='gestion_camions.camion')),
            ],
            options={
                'verbose_name': 'Maintenance camion',
                'verbose_name_plural': 'Maintenances camions',
                'ordering': ['-date_maintenance'],
            },
        ),
        migrations.CreateModel(
            name='PaiementRedevance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('periode_debut', models.DateField()),
                ('periode_fin', models.DateField()),
                ('montant_du', models.DecimalField(decimal_places=2, max_digits=10)),
                ('montant_paye', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('date_echeance', models.DateField()),
                ('date_paiement', models.DateField(blank=True, null=True)),
                ('statut', models.CharField(choices=[('en_attente', 'En attente'), ('paye', 'Payé'), ('retard', 'En retard'), ('litige', 'Litige')], default='en_attente', max_length=20)),
                ('mode_paiement', models.CharField(choices=[('virement', 'Virement'), ('cheque', 'Chèque'), ('carte', 'Carte bancaire'), ('especes', 'Espèces')], default='virement', max_length=20)),
                ('reference_paiement', models.CharField(blank=True, max_length=50)),
                ('commentaire', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('franchise', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='paiements', to='gestion_camions.franchise')),
            ],
            options={
                'verbose_name': 'Paiement redevance',
                'verbose_name_plural': 'Paiements redevances',
                'ordering': ['-date_echeance'],
            },
        ),
        migrations.CreateModel(
            name='Produit',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('nom_produit', models.CharField(max_length=100)),
                ('prix_unitaire', models.DecimalField(decimal_places=2, max_digits=6)),
                ('unite', models.CharField(choices=[('kg', 'Kilogramme'), ('litre', 'Litre'), ('piece', 'Pièce'), ('boite', 'Boîte'), ('sachet', 'Sachet')], default='piece', max_length=20)),
                ('stock_minimum', models.PositiveIntegerField(default=0)),
                ('fournisseur_principal', models.CharField(blank=True, max_length=100)),
                ('statut', models.CharField(choices=[('actif', 'Actif'), ('discontinue', 'Discontinué')], default='actif', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('categorie', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='produits', to='gestion_camions.categorieproduit')),
                ('entrepot_principal', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='produits_principaux', to='gestion_camions.entrepot')),
            ],
            options={
                'verbose_name': 'Produit',
                'verbose_name_plural': 'Produits',
            },
        ),
        migrations.CreateModel(
            name='DetailCommande',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantite_commandee', models.PositiveIntegerField()),
                ('prix_unitaire', models.DecimalField(decimal_places=2, max_digits=6)),
                ('sous_total', models.DecimalField(decimal_places=2, max_digits=8)),
                ('type_achat', models.CharField(choices=[('obligatoire', 'Obligatoire (80%)'), ('libre', 'Libre (20%)')], max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('commande', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='details', to='gestion_camions.commandefranchise')),
                ('produit', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='details_commandes', to='gestion_camions.produit')),
            ],
            options={
                'verbose_name': 'Détail commande',
                'verbose_name_plural': 'Détails commandes',
            },
        ),
        migrations.CreateModel(
            name='StockEntrepot',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('quantite_disponible', models.PositiveIntegerField(default=0)),
                ('quantite_reservee', models.PositiveIntegerField(default=0)),
                ('seuil_alerte', models.PositiveIntegerField(default=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('entrepot', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='stocks', to='gestion_camions.entrepot')),
                ('produit', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='stocks', to='gestion_camions.produit')),
            ],
            options={
                'verbose_name': 'Stock entrepôt',
                'verbose_name_plural': 'Stocks entrepôts',
                'unique_together': {('produit', 'entrepot')},
            },
        ),
        migrations.CreateModel(
            name='VenteFranchise',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date_vente', models.DateField()),
                ('chiffre_affaires_jour', models.DecimalField(decimal_places=2, max_digits=10)),
                ('redevance_due', models.DecimalField(decimal_places=2, max_digits=8)),
                ('nombre_transactions', models.PositiveIntegerField(default=0)),
                ('commentaire', models.TextField(blank=True)),
                ('statut', models.CharField(choices=[('en_attente', 'En attente'), ('validee', 'Validée'), ('payee', 'Payée')], default='en_attente', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('franchise', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='ventes', to='gestion_camions.franchise')),
            ],
            options={
                'verbose_name': 'Vente franchise',
                'verbose_name_plural': 'Ventes franchises',
                'ordering': ['-date_vente'],
                'unique_together': {('franchise', 'date_vente')},
            },
        ),
    ]
